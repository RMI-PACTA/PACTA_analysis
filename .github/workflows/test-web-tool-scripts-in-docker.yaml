name: Run web tool scripts on custom docker

on: [push, pull_request]

jobs:
  setup_docker_host:
    runs-on: ubuntu-16.04
    steps:
      - name: Checkout PACTA_analysis
        uses: actions/checkout@v2
        with:
          path: PACTA_analysis
      - name: Checkout pacta-data
        uses: actions/checkout@v2
        with:
          repository: 2DegreesInvesting/pacta-data
          token: ${{ secrets.MAURO_PAT_FOR_2DII }}
          path: pacta-data
      - name: Checkout create_interactive_report
        uses: actions/checkout@v2
        with:
          repository: 2DegreesInvesting/create_interactive_report
          token: ${{ secrets.MAURO_PAT_FOR_2DII }}
          path: create_interactive_report
      - name: Checkout StressTestingModelDev
        uses: actions/checkout@v2
        with:
          repository: 2DegreesInvesting/StressTestingModelDev
          token: ${{ secrets.MAURO_PAT_FOR_2DII }}
          path: StressTestingModelDev
      - name: Checkout user_results
        uses: actions/checkout@v2
        with:
          repository: 2DegreesInvesting/user_results
          token: ${{ secrets.MAURO_PAT_FOR_2DII }}
          path: user_results
  setup_docker_instance:
    runs-on: ubuntu-18.04
    container:
      image: 2dii/r-packages
      volumes:
        - ${{ github.workspace }}/PACTA_analysis:/bound
        - ${{ github.workspace }}/create_interactive_report:/create_interactive_report
        - ${{ github.workspace }}/StressTestingModelDev:/StressTestingModelDev
        - ${{ github.workspace }}/pacta-data:/pacta-data
        - ${{ github.workspace }}/user_reports:/user_reports
    steps:
      - name: print working directory
        run: |
          pwd
          ls -al
          cd /
          pwd
          ls -al
          cd /bound
          ls -al
          ls -al bin
          ./bin/run-web-tool
